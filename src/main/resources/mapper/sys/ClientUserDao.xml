<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.cwnu.modules.sys.dao.ClientUserDao">

    <!--查询所有用户信息-->
    <select id="queryInfoList" resultType="cn.cwnu.modules.sys.entity.ClientUserEntity">
        select * from `client_user`
        WHERE 1 = 1
        <if test='searchText != null and searchText != "" '>
            AND (account = #{searchText} OR username = #{searchText} OR id_card = #{searchText})
        </if>
        ORDER BY id DESC
    </select>
    <select id="queryByGroup" resultType="cn.cwnu.modules.sys.entity.ClientUserEntity">
        select * from `client_user`
        where type=0 and groupId= #{gid}
    </select>
<!--机构下的人-->
    <select id="queryByDept" resultType="cn.cwnu.modules.sys.entity.ClientUserEntity">
        select * from `client_user`
        where type=1 and deptId= #{id}
    </select>
<!--机构下所有人-->
    <select id="queryAllByDept" resultType="cn.cwnu.modules.sys.entity.ClientUserEntity">
        select * from `client_user`
        where deptId= #{id}
    </select>
    <!--数据批量保存-->
<!--    <insert id="batchInsert" parameterType="java.util.List">
        INSERT INTO `client_user`
        (department_name, username, personnel_code, job_title, administrative_duties, post_setting, personnel_category)
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (#{item.departmentName}, #{item.username}, #{item.personnelCode}, #{item.jobTitle},
            #{item.administrativeDuties}, #{item.postSetting}, #{item.personnelCategory})
        </foreach>
    </insert>-->

    <insert id="save" parameterType="cn.cwnu.modules.sys.entity.ClientUserEntity" useGeneratedKeys="true">
         INSERT INTO `client_user`
        (`username`, `realname`, `account`, `password`,`salt`,
         `status`, `create_time`,`update_time`,`login_time`,`remarks`,`phone`,
         `groupId`,`dept`,`level`,`sex`,`email`,`bank`,`bank_num`,`address`,`type`,`deptId`)
        VALUES(#{username},#{realname},#{account},#{password},#{salt},
        #{status},#{createTime},#{updateTime},#{loginTime},#{remarks},#{phone},
        #{groupId},#{dept},#{level},#{sex},#{email},#{bank},#{bankNum},#{address},#{type},#{deptId})
    </insert>



    <!--删除数据-->
    <delete id="delete">
		delete from `client_user` where id = #{value}
	</delete>

    <!--禁用用户-->
    <update id="ban" parameterType="int">
        update `client_user` set status = 0 where id = #{id}
    </update>

    <!--激活用户-->
    <update id="use" parameterType="int">
        update `client_user` set status = 1 where id = #{id}
    </update>
</mapper>